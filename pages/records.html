<!DOCTYPE html>
<html lang="en" class="light-style layout-menu-fixed" dir="ltr" data-theme="theme-default" data-assets-path="../assets/"
    data-template="vertical-menu-template-free">

<head>
    <meta charset="utf-8" />
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0" />
    <title>Trang Ghi Âm</title>
    <meta name="description" content="" />

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="../assets/img/favicon/favicon.ico" />

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
        href="https://fonts.googleapis.com/css2?family=Public+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&display=swap"
        rel="stylesheet" />

    <!-- Icons -->
    <link rel="stylesheet" href="../assets/vendor/fonts/boxicons.css" />

    <!-- Core CSS -->
    <link rel="stylesheet" href="../assets/vendor/css/core.css" class="template-customizer-core-css" />
    <link rel="stylesheet" href="../assets/vendor/css/theme-default.css" class="template-customizer-theme-css" />
    <link rel="stylesheet" href="../assets/css/demo.css" />

    <!-- Vendors CSS -->
    <link rel="stylesheet" href="../assets/vendor/libs/perfect-scrollbar/perfect-scrollbar.css" />
    <link rel="stylesheet" href="../assets/vendor/libs/apex-charts/apex-charts.css" />

    <!-- Helpers -->
    <script src="../assets/vendor/js/helpers.js"></script>
    <script src="../assets/js/config.js"></script>

    <!-- SweetAlert2 CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">

    <style>
        .folder-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 15px;
        }

        .folder-item {
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: background-color 0.3s ease, border-color 0.3s ease;
        }

        .folder-item:hover {
            background-color: #f1f1f1;
        }

        .folder-item.selected {
            background-color: #cce5ff;
            border-color: #66b0ff;
        }
    </style>
</head>

<body>
    <!-- Layout wrapper -->
    <div class="layout-wrapper layout-content-navbar">
        <div class="layout-container">
            <!-- Menu Sidebar -->
            <div id="sidebar"></div>
            <script>
                fetch("layout/sidebar.html")
                    .then(response => response.text())
                    .then(data => {
                        document.getElementById("sidebar").innerHTML = data;
                    });
            </script>
            <!-- / Menu -->

            <!-- Layout container -->
            <div class="layout-page">
                <!-- Navbar -->
                <nav class="layout-navbar container-xxl navbar navbar-expand-xl navbar-detached align-items-center bg-navbar-theme"
                    id="layout-navbar">
                    <div class="layout-menu-toggle navbar-nav align-items-xl-center me-3 me-xl-0 d-xl-none">
                        <a class="nav-item nav-link px-0 me-xl-4" href="javascript:void(0)">
                            <i class="bx bx-menu bx-sm"></i>
                        </a>
                    </div>
                    <div class="navbar-nav-right d-flex align-items-center" id="navbar-collapse">
                        <!-- Search -->
                        <div class="navbar-nav align-items-center">
                            <div class="nav-item d-flex align-items-center">
                                <i class="bx bx-search fs-4 lh-0"></i>
                                <input type="text" class="form-control border-0 shadow-none" placeholder="Search..."
                                    aria-label="Search..." />
                            </div>
                        </div>
                        <!-- /Search -->
                        <ul class="navbar-nav flex-row align-items-center ms-auto">
                            <!-- User -->
                            <li class="nav-item navbar-dropdown dropdown-user dropdown">
                                <a class="nav-link dropdown-toggle hide-arrow" href="javascript:void(0);"
                                    data-bs-toggle="dropdown">
                                    <div class="avatar avatar-online">
                                        <img src="../assets/img/avatars/1.png" alt
                                            class="w-px-40 h-auto rounded-circle" />
                                    </div>
                                </a>
                                <ul class="dropdown-menu dropdown-menu-end">
                                    <li>
                                        <a class="dropdown-item" href="#">
                                            <div class="d-flex">
                                                <div class="flex-shrink-0 me-3">
                                                    <div class="avatar avatar-online">
                                                        <img src="../assets/img/avatars/1.png" alt
                                                            class="w-px-40 h-auto rounded-circle" />
                                                    </div>
                                                </div>
                                                <div class="flex-grow-1">
                                                    <span class="fw-semibold d-block">John Doe</span>
                                                    <small class="text-muted">Admin</small>
                                                </div>
                                            </div>
                                        </a>
                                    </li>
                                    <li>
                                        <div class="dropdown-divider"></div>
                                    </li>
                                    <li>
                                        <a class="dropdown-item" href="#">
                                            <i class="bx bx-user me-2"></i>
                                            <span class="align-middle">My Profile</span>
                                        </a>
                                    </li>
                                    <li>
                                        <a class="dropdown-item" href="#">
                                            <i class="bx bx-cog me-2"></i>
                                            <span class="align-middle">Settings</span>
                                        </a>
                                    </li>
                                    <li>
                                        <div class="dropdown-divider"></div>
                                    </li>
                                    <li>
                                        <a class="dropdown-item" href="auth-login-basic.html">
                                            <i class="bx bx-power-off me-2"></i>
                                            <span class="align-middle">Log Out</span>
                                        </a>
                                    </li>
                                </ul>
                            </li>
                            <!--/ User -->
                        </ul>
                    </div>
                </nav>
                <!-- / Navbar -->

                <!-- Content wrapper -->
                <div class="content-wrapper">
                    <!-- Content -->
                    <div class="container-xxl flex-grow-1 container-p-y">
                        <div class="card">
                            <!-- Card body: chiều cao tối thiểu để không bị ép nhỏ -->
                            <div class="card-body d-flex flex-column" style="min-height: 80vh; padding: 20px;">

                                <!-- Vùng hiển thị văn bản chuyển đổi -->
                                <div class="mb-4 flex-grow-1">
                                    <label for="transcription" class="form-label fw-bold">Văn bản chuyển đổi:</label>
                                    <textarea id="transcription" class="form-control p-3"
                                        style="height: 60vh; resize: none;"
                                        placeholder="Văn bản chuyển đổi sẽ hiển thị tại đây..." readonly>
Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec venenatis, nulla ac auctor luctus, 
leo dolor condimentum arcu, a interdum arcu enim sed justo. Suspendisse at sollicitudin quam. Nam at urna quam. Pellentesque in ullamcorper arcu. Cras congue ante sed lacus cursus, ac maximus ligula dapibus. Aliquam erat volutpat. Duis vitae tellus nulla. Phasellus at dui non metus bibendum fermentum.
                  </textarea>
                                </div>

                                <!-- Hiển thị trạng thái ghi âm -->
                                <div class="mb-3">
                                    <span id="recording-status" class="badge bg-secondary p-2">Trạng thái: Chưa ghi
                                        âm</span>
                                </div>

                                <!-- Các nút chức năng ghi âm & tải file -->
                                <div class="d-flex justify-content-between align-items-center mb-4">
                                    <button class="btn btn-primary btn-lg d-flex align-items-center"
                                        id="toggle-recording">
                                        <i class="bx bx-microphone me-2 fs-4" id="toggle-icon"></i>
                                        <span id="toggle-text">Bắt đầu ghi âm</span>
                                    </button>
                                    <button class="btn btn-secondary btn-lg d-flex align-items-center" id="upload-file">
                                        <i class="bx bx-upload me-2 fs-4"></i> Tải file lên
                                    </button>
                                </div>

                                <!-- Nút mở modal lưu file -->
                                <div class="d-flex justify-content-center align-items-center mt-4">
                                    <button type="button" class="btn btn-info btn-lg d-flex align-items-center"
                                        data-bs-toggle="modal" data-bs-target="#saveModal">
                                        <i class="bx bx-save me-2 fs-4"></i> Lưu file
                                    </button>
                                </div>

                            </div>
                        </div>
                    </div>
                    <!-- / Content -->

                    <div class="content-backdrop fade"></div>
                </div>
                <!-- / Content wrapper -->

            </div>
            <!-- / Layout page -->
        </div>

        <!-- Overlay -->
        <div class="layout-overlay layout-menu-toggle"></div>
    </div>
    <!-- / Layout wrapper -->

    <!-- Modal lưu file -->
    <div class="modal fade" id="saveModal" tabindex="-1" aria-labelledby="saveModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="saveModalLabel">Lưu file</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Đóng"></button>
                </div>
                <div class="modal-body">
                    <!-- Nhập tên file -->
                    <div class="mb-3">
                        <label for="fileNameModal" class="form-label fw-bold">Tên file:</label>
                        <input type="text" id="fileNameModal" class="form-control" placeholder="Nhập tên file..."
                            value="default.txt">
                    </div>
                    <!-- Tìm kiếm & chọn folder -->
                    <div class="mb-3">
                        <label for="folderSearchModal" class="form-label fw-bold">Chọn Folder:</label>
                        <input type="text" id="folderSearchModal" class="form-control mb-3" placeholder="Tìm folder...">
                        <div class="folder-grid" id="folderGridModal">
                            <div class="folder-item" data-folder="folder1">
                                <i class="bx bx-folder fs-1"></i>
                                <div>Folder 1</div>
                            </div>
                            <div class="folder-item" data-folder="folder2">
                                <i class="bx bx-folder fs-1"></i>
                                <div>Folder 2</div>
                            </div>
                            <div class="folder-item" data-folder="folder3">
                                <i class="bx bx-folder fs-1"></i>
                                <div>Folder 3</div>
                            </div>
                            <!-- Thêm folder khác nếu cần -->
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Đóng</button>
                    <button type="button" class="btn btn-success" id="modalSaveBtn">Lưu</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Thêm SweetAlert2 qua CDN -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <!-- Script xử lý ghi âm, tải file và lưu file -->
    <script>
        // --- Xử lý ghi âm ---
        const toggleBtn = document.getElementById('toggle-recording');
        const toggleIcon = document.getElementById('toggle-icon');
        const toggleText = document.getElementById('toggle-text');
        const statusText = document.getElementById('recording-status');
        let isRecording = false;
        toggleBtn.addEventListener('click', function() {
            if (!isRecording) {
                // Bắt đầu ghi âm
                isRecording = true;
                statusText.textContent = 'Trạng thái: Đang ghi âm...';
                toggleIcon.className = 'bx bx-microphone-off';
                toggleText.textContent = 'Dừng ghi âm';
                // TODO: Khởi tạo API ghi âm và cập nhật nội dung vào textarea
            } else {
                // Dừng ghi âm
                isRecording = false;
                statusText.textContent = 'Trạng thái: Đã dừng ghi âm';
                toggleIcon.className = 'bx bx-microphone';
                toggleText.textContent = 'Bắt đầu ghi âm';
                // TODO: Dừng ghi âm và xử lý văn bản chuyển đổi (nếu có)
            }
        });
        // --- Xử lý tải file lên ---
        document.getElementById('upload-file').addEventListener('click', function() {
            const fileInput = document.createElement('input');
            fileInput.type = 'file';
            fileInput.accept = 'audio/*';
            fileInput.onchange = event => {
                const file = event.target.files[0];
                if (file) {
                    // TODO: Xử lý tải file và chuyển đổi thành văn bản
                    Swal.fire({
                        icon: 'success',
                        title: 'File đã được chọn',
                        text: file.name,
                        timer: 2000,
                        showConfirmButton: false
                    });
                }
            };
            fileInput.click();
        });
        // --- Xử lý chọn folder trong modal ---
        document.querySelectorAll('#folderGridModal .folder-item').forEach(item => {
            item.addEventListener('click', function() {
                document.querySelectorAll('#folderGridModal .folder-item').forEach(el => el.classList
                    .remove('selected'));
                this.classList.add('selected');
            });
        });
        // --- Xử lý tìm kiếm folder trong modal ---
        document.getElementById('folderSearchModal').addEventListener('input', function() {
            const searchValue = this.value.toLowerCase();
            document.querySelectorAll('#folderGridModal .folder-item').forEach(item => {
                const folderName = item.textContent.toLowerCase();
                if (folderName.indexOf(searchValue) !== -1) {
                    item.style.display = '';
                } else {
                    item.style.display = 'none';
                }
            });
        });
        // --- Xử lý lưu file từ modal ---
        document.getElementById('modalSaveBtn').addEventListener('click', function() {
            const fileName = document.getElementById('fileNameModal').value.trim();
            const selectedFolderEl = document.querySelector('#saveModal .folder-item.selected');
            if (fileName === '') {
                Swal.fire({
                    icon: 'error',
                    title: 'Lỗi',
                    text: 'Vui lòng nhập tên file!'
                });
                return;
            }
            if (!selectedFolderEl) {
                Swal.fire({
                    icon: 'error',
                    title: 'Lỗi',
                    text: 'Vui lòng chọn folder!'
                });
                return;
            }
            const selectedFolder = selectedFolderEl.getAttribute('data-folder');
            const transcriptionText = document.getElementById('transcription').value;
            // TODO: Thực hiện lưu file với tên file, nội dung chuyển đổi và folder đã chọn qua API hoặc xử lý lưu trữ
            Swal.fire({
                icon: 'success',
                title: 'Đã lưu',
                text: `Đã lưu file "${fileName}" vào ${selectedFolder}`,
                timer: 2500,
                showConfirmButton: false
            });
            // Đóng modal sau khi lưu
            const saveModalEl = document.getElementById('saveModal');
            const modalInstance = bootstrap.Modal.getInstance(saveModalEl);
            modalInstance.hide();
        });
    </script>

    <!-- Core JS -->
    <script src="../assets/vendor/libs/jquery/jquery.js"></script>
    <script src="../assets/vendor/libs/popper/popper.js"></script>
    <script src="../assets/vendor/js/bootstrap.js"></script>
    <script src="../assets/vendor/libs/perfect-scrollbar/perfect-scrollbar.js"></script>
    <script src="../assets/vendor/js/menu.js"></script>
    <!-- Vendors JS -->
    <script src="../assets/vendor/libs/apex-charts/apexcharts.js"></script>
    <!-- Main JS -->
    <script src="../assets/js/main.js"></script>
    <script src="../assets/js/dashboards-analytics.js"></script>
    <script async defer src="https://buttons.github.io/buttons.js"></script>
</body>

</html>